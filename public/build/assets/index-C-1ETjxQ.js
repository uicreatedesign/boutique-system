import{d as he,c as de,j as s,r as c,t as X,e as xe,H as ue,a as fe}from"./app-CuMYGVkL.js";import{B as re,S as je,A as pe}from"./app-layout-BRI9TXqx.js";import{B as k}from"./app-logo-icon-ChWx987R.js";import{I as K}from"./input-DUSeuPxY.js";import{c as le,a as oe,C as ne,b as ie}from"./card-BDhQKKtt.js";import{c as Y,b as Z,D as ce,a as ee,d as ge,f as Ne,e as be}from"./dialog-ChWoKwXJ.js";import{a as ye,u as Ce,o as ve,s as W,l as Q}from"./schemas-_GgH1UTk.js";import{L as G}from"./label-DIWDA_IM.js";import{T as Se}from"./textarea-DsA_uSMC.js";import{P as we}from"./pagination-BlPLaBlq.js";import{S as T}from"./skeleton-DaVMMtle.js";import{E as _e}from"./eye-Fs7UDTpb.js";import{S as De}from"./square-pen-YsOr5ekF.js";import{T as Pe}from"./trash-2-pW9MuKgQ.js";import{d as Fe}from"./index-C4J_hXM0.js";import{P as Le}from"./plus-CTqo1sn6.js";/* empty css            */import"./index-Bs1rG-Bl.js";import"./index-B-cXXmOe.js";import"./select-L2oKoFgp.js";import"./index-CHaiS2Tr.js";import"./check-DiwIk02C.js";import"./chevron-left-C3ThC35T.js";const M=he.create({baseURL:"/api",headers:{"Content-Type":"application/json",Accept:"application/json","X-Requested-With":"XMLHttpRequest"}});M.interceptors.request.use(t=>{const e=document.querySelector('meta[name="csrf-token"]')?.getAttribute("content");return e&&(t.headers["X-CSRF-TOKEN"]=e),t});const Oe=t=>M.get("/customers",{params:t}),Ee=t=>M.post("/customers",t),Te=(t,e)=>M.put(`/customers/${t}`,e),ke=t=>M.delete(`/customers/${t}`),Me=t=>M.get(`/customers/${t}`),Ae=(t,e)=>M.get(`/customers/${t}/orders`,{params:e}),Re=ve({name:W().min(1,"Name is required").max(191),phone:W().max(20).optional().or(Q("")),email:W().email("Invalid email").max(191).optional().or(Q("")),address:W().optional().or(Q("")),dob:W().optional().or(Q(""))});function me(t){const e=de.c(72),{onSubmit:u,loading:r,initialData:d}=t;let n;e[0]===Symbol.for("react.memo_cache_sentinel")?(n=ye(Re),e[0]=n):n=e[0];let h;e[1]!==d?(h={resolver:n,defaultValues:d},e[1]=d,e[2]=h):h=e[2];const{register:l,handleSubmit:f,formState:D}=Ce(h),{errors:a}=D;let o;e[3]!==f||e[4]!==u?(o=f(u),e[3]=f,e[4]=u,e[5]=o):o=e[5];let N;e[6]===Symbol.for("react.memo_cache_sentinel")?(N=s.jsx(G,{htmlFor:"name",children:"Name *"}),e[6]=N):N=e[6];let j;e[7]!==l?(j=l("name"),e[7]=l,e[8]=j):j=e[8];const P=a.name?"border-red-500":"";let C;e[9]!==j||e[10]!==P?(C=s.jsx(K,{id:"name",...j,className:P}),e[9]=j,e[10]=P,e[11]=C):C=e[11];let b;e[12]!==a.name?(b=a.name&&s.jsx("p",{className:"text-red-500 text-sm mt-1",children:a.name.message}),e[12]=a.name,e[13]=b):b=e[13];let p;e[14]!==C||e[15]!==b?(p=s.jsxs("div",{children:[N,C,b]}),e[14]=C,e[15]=b,e[16]=p):p=e[16];let y;e[17]===Symbol.for("react.memo_cache_sentinel")?(y=s.jsx(G,{htmlFor:"phone",children:"Phone"}),e[17]=y):y=e[17];let g;e[18]!==l?(g=l("phone"),e[18]=l,e[19]=g):g=e[19];const v=a.phone?"border-red-500":"";let m;e[20]!==g||e[21]!==v?(m=s.jsx(K,{id:"phone",...g,className:v}),e[20]=g,e[21]=v,e[22]=m):m=e[22];let S;e[23]!==a.phone?(S=a.phone&&s.jsx("p",{className:"text-red-500 text-sm mt-1",children:a.phone.message}),e[23]=a.phone,e[24]=S):S=e[24];let x;e[25]!==m||e[26]!==S?(x=s.jsxs("div",{children:[y,m,S]}),e[25]=m,e[26]=S,e[27]=x):x=e[27];let w;e[28]===Symbol.for("react.memo_cache_sentinel")?(w=s.jsx(G,{htmlFor:"email",children:"Email"}),e[28]=w):w=e[28];let O;e[29]!==l?(O=l("email"),e[29]=l,e[30]=O):O=e[30];const i=a.email?"border-red-500":"";let L;e[31]!==O||e[32]!==i?(L=s.jsx(K,{id:"email",type:"email",...O,className:i}),e[31]=O,e[32]=i,e[33]=L):L=e[33];let _;e[34]!==a.email?(_=a.email&&s.jsx("p",{className:"text-red-500 text-sm mt-1",children:a.email.message}),e[34]=a.email,e[35]=_):_=e[35];let E;e[36]!==L||e[37]!==_?(E=s.jsxs("div",{children:[w,L,_]}),e[36]=L,e[37]=_,e[38]=E):E=e[38];let F;e[39]===Symbol.for("react.memo_cache_sentinel")?(F=s.jsx(G,{htmlFor:"address",children:"Address"}),e[39]=F):F=e[39];let A;e[40]!==l?(A=l("address"),e[40]=l,e[41]=A):A=e[41];const se=a.address?"border-red-500":"";let R;e[42]!==A||e[43]!==se?(R=s.jsx(Se,{id:"address",...A,className:se}),e[42]=A,e[43]=se,e[44]=R):R=e[44];let $;e[45]!==a.address?($=a.address&&s.jsx("p",{className:"text-red-500 text-sm mt-1",children:a.address.message}),e[45]=a.address,e[46]=$):$=e[46];let B;e[47]!==R||e[48]!==$?(B=s.jsxs("div",{children:[F,R,$]}),e[47]=R,e[48]=$,e[49]=B):B=e[49];let V;e[50]===Symbol.for("react.memo_cache_sentinel")?(V=s.jsx(G,{htmlFor:"dob",children:"Date of Birth"}),e[50]=V):V=e[50];let H;e[51]!==l?(H=l("dob"),e[51]=l,e[52]=H):H=e[52];const te=a.dob?"border-red-500":"";let q;e[53]!==H||e[54]!==te?(q=s.jsx(K,{id:"dob",type:"date",...H,className:te}),e[53]=H,e[54]=te,e[55]=q):q=e[55];let z;e[56]!==a.dob?(z=a.dob&&s.jsx("p",{className:"text-red-500 text-sm mt-1",children:a.dob.message}),e[56]=a.dob,e[57]=z):z=e[57];let I;e[58]!==q||e[59]!==z?(I=s.jsxs("div",{children:[V,q,z]}),e[58]=q,e[59]=z,e[60]=I):I=e[60];const ae=r?"Saving...":"Save Customer";let U;e[61]!==r||e[62]!==ae?(U=s.jsx(k,{type:"submit",disabled:r,className:"w-full",children:ae}),e[61]=r,e[62]=ae,e[63]=U):U=e[63];let J;return e[64]!==p||e[65]!==x||e[66]!==E||e[67]!==B||e[68]!==I||e[69]!==U||e[70]!==o?(J=s.jsxs("form",{onSubmit:o,className:"space-y-4",children:[p,x,E,B,I,U]}),e[64]=p,e[65]=x,e[66]=E,e[67]=B,e[68]=I,e[69]=U,e[70]=o,e[71]=J):J=e[71],J}function $e({customer:t,open:e,onClose:u,onSuccess:r}){const[d,n]=c.useState(!1),h=async l=>{try{n(!0),await Te(t.id,l),X.success(`${t.name} updated successfully`),r()}catch(f){console.error("Failed to update customer:",f),X.error("Failed to update customer. Please try again.")}finally{n(!1)}};return s.jsx(Y,{open:e,onOpenChange:u,children:s.jsxs(Z,{className:"max-w-md","aria-describedby":"customer-edit-description",children:[s.jsx(ce,{children:s.jsx(ee,{children:"Edit Customer"})}),s.jsx("div",{id:"customer-edit-description",className:"sr-only",children:"Form to edit customer information"}),s.jsx(me,{onSubmit:h,loading:d,initialData:t})]})})}function Be({customer:t,open:e,onClose:u}){const[r,d]=c.useState(null),[n,h]=c.useState([]),[l,f]=c.useState(!0);c.useEffect(()=>{e&&t&&(D(),a())},[e,t]);const D=async()=>{try{const o=await Me(t.id);d(o.data.data)}catch(o){console.error("Failed to fetch customer detail:",o)}},a=async()=>{try{const o=await Ae(t.id);h(o.data.data)}catch(o){console.error("Failed to fetch customer orders:",o)}finally{f(!1)}};return s.jsx(Y,{open:e,onOpenChange:u,children:s.jsxs(Z,{className:"max-w-2xl max-h-[80vh] overflow-y-auto","aria-describedby":"customer-detail-description",children:[s.jsx(ce,{children:s.jsx(ee,{children:"Customer Details"})}),s.jsx("div",{id:"customer-detail-description",className:"sr-only",children:"Detailed view of customer information and order history"}),l?s.jsx("div",{className:"text-center py-4",children:"Loading..."}):s.jsxs("div",{className:"space-y-6",children:[s.jsxs(le,{children:[s.jsx(oe,{children:s.jsx(ne,{children:"Customer Information"})}),s.jsxs(ie,{className:"space-y-2",children:[s.jsxs("div",{children:[s.jsx("strong",{children:"Name:"})," ",r?.name]}),r?.phone&&s.jsxs("div",{children:[s.jsx("strong",{children:"Phone:"})," ",r.phone]}),r?.email&&s.jsxs("div",{children:[s.jsx("strong",{children:"Email:"})," ",r.email]}),r?.address&&s.jsxs("div",{children:[s.jsx("strong",{children:"Address:"})," ",r.address]}),r?.dob&&s.jsxs("div",{children:[s.jsx("strong",{children:"Date of Birth:"})," ",r.dob]}),s.jsxs("div",{children:[s.jsx("strong",{children:"Total Orders:"})," ",s.jsx(re,{children:r?.orders_count})]}),r?.last_order_at&&s.jsxs("div",{children:[s.jsx("strong",{children:"Last Order:"})," ",new Date(r.last_order_at).toLocaleDateString()]})]})]}),s.jsxs(le,{children:[s.jsx(oe,{children:s.jsx(ne,{children:"Recent Orders"})}),s.jsx(ie,{children:n.length>0?s.jsx("div",{className:"space-y-2",children:n.map(o=>s.jsxs("div",{className:"p-3 border rounded",children:[s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsxs("span",{children:["Order #",o.id]}),s.jsx(re,{variant:"outline",children:o.status})]}),s.jsx("div",{className:"text-sm text-gray-600",children:new Date(o.created_at).toLocaleDateString()})]},o.id))}):s.jsx("p",{className:"text-gray-500",children:"No orders found"})})]})]})]})})}function He({customer:t,open:e,onClose:u,onSuccess:r}){const[d,n]=c.useState(!1),h=async()=>{if(t)try{n(!0),await ke(t.id),X.success(`${t.name} has been successfully deleted`),r(),u()}catch(l){console.error("Failed to delete customer:",l),X.error("Failed to delete customer. Please try again.")}finally{n(!1)}};return s.jsx(Y,{open:e,onOpenChange:u,children:s.jsxs(Z,{"aria-describedby":"delete-customer-description",children:[s.jsx(ee,{children:"Are you sure you want to delete this customer?"}),s.jsxs(ge,{id:"delete-customer-description",children:["Once deleted, all of ",t?.name,"'s data will be permanently removed. This action cannot be undone."]}),s.jsxs(Ne,{className:"gap-2",children:[s.jsx(be,{asChild:!0,children:s.jsx(k,{variant:"secondary",children:"Cancel"})}),s.jsx(k,{variant:"destructive",disabled:d,onClick:h,children:d?"Deleting...":"Delete Customer"})]})]})})}function qe({search:t}){const[e,u]=c.useState([]),[r,d]=c.useState(!1),[n,h]=c.useState(null),[l,f]=c.useState(null),[D,a]=c.useState(null),[o,N]=c.useState(1),[j,P]=c.useState(0),[C,b]=c.useState(0),[p,y]=c.useState(0),[g,v]=c.useState(0),[m,S]=c.useState(10),x=async(i=1,L=m)=>{try{d(!0);const _=await Oe({search:t,page:i,per_page:L});console.log("Full Response:",_.data);const E=_.data.data||[],F=_.data.meta||_.data;console.log("Meta:",F),u(E),N(F.current_page||1),P(F.last_page||1),b(F.total||0),y(F.from||0),v(F.to||0)}catch(_){console.error("Failed to fetch customers:",_),u([]),b(0),y(0),v(0),P(0)}finally{d(!1)}};c.useEffect(()=>{x(1,m)},[]),c.useEffect(()=>{const i=setTimeout(()=>{N(1),x(1,m)},300);return()=>clearTimeout(i)},[t]),c.useEffect(()=>{m!==10&&x(1,m)},[m]);const w=i=>{N(i),x(i,m)},O=i=>{S(i),N(1)};return r&&e.length===0?s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"w-full border-collapse",children:[s.jsx("thead",{children:s.jsxs("tr",{className:"border-b",children:[s.jsx("th",{className:"text-left p-4",children:"Name"}),s.jsx("th",{className:"text-left p-4",children:"Contact"}),s.jsx("th",{className:"text-left p-4",children:"Orders"}),s.jsx("th",{className:"text-left p-4",children:"Last Order"}),s.jsx("th",{className:"text-left p-4",children:"Actions"})]})}),s.jsx("tbody",{children:[...Array(5)].map((i,L)=>s.jsxs("tr",{className:"border-b",children:[s.jsx("td",{className:"p-4",children:s.jsx(T,{className:"h-5 w-32"})}),s.jsx("td",{className:"p-4",children:s.jsxs("div",{className:"space-y-2",children:[s.jsx(T,{className:"h-4 w-28"}),s.jsx(T,{className:"h-4 w-36"})]})}),s.jsx("td",{className:"p-4",children:s.jsx(T,{className:"h-6 w-8"})}),s.jsx("td",{className:"p-4",children:s.jsx(T,{className:"h-4 w-24"})}),s.jsx("td",{className:"p-4",children:s.jsxs("div",{className:"flex space-x-2",children:[s.jsx(T,{className:"h-9 w-9"}),s.jsx(T,{className:"h-9 w-9"}),s.jsx(T,{className:"h-9 w-9"})]})})]},L))})]})}):s.jsxs(s.Fragment,{children:[e.length===0&&!r?s.jsxs("div",{className:"flex flex-col items-center justify-center py-16 px-4",children:[s.jsx("svg",{className:"w-48 h-48 mb-6 text-gray-300",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1,d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})}),s.jsx("h3",{className:"text-xl font-semibold text-gray-700 mb-2",children:"No Customers Found"}),s.jsx("p",{className:"text-gray-500 text-center mb-6 max-w-md",children:t?"No customers match your search criteria.":"Get started by adding your first customer."})]}):s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"w-full border-collapse",children:[s.jsx("thead",{children:s.jsxs("tr",{className:"border-b",children:[s.jsx("th",{className:"text-left p-4",children:"Name"}),s.jsx("th",{className:"text-left p-4",children:"Contact"}),s.jsx("th",{className:"text-left p-4",children:"Orders"}),s.jsx("th",{className:"text-left p-4",children:"Last Order"}),s.jsx("th",{className:"text-left p-4",children:"Actions"})]})}),s.jsx("tbody",{children:e.map(i=>s.jsxs("tr",{className:"border-b hover:bg-gray-50 dark:hover:bg-[oklch(0.269_0_0)]",children:[s.jsx("td",{className:"p-4 font-medium",children:i.name}),s.jsx("td",{className:"p-4",children:s.jsxs("div",{className:"space-y-1",children:[i.phone&&s.jsx("div",{className:"text-sm",children:i.phone}),i.email&&s.jsx("div",{className:"text-sm text-gray-600",children:i.email})]})}),s.jsx("td",{className:"p-4",children:s.jsx(re,{variant:"secondary",children:i.orders_count})}),s.jsx("td",{className:"p-4 text-sm text-gray-600",children:i.last_order_at?new Date(i.last_order_at).toLocaleDateString():"Never"}),s.jsx("td",{className:"p-4",children:s.jsxs("div",{className:"flex space-x-2",children:[s.jsx(k,{size:"sm",variant:"outline",onClick:()=>f(i),children:s.jsx(_e,{className:"h-4 w-4"})}),s.jsx(k,{size:"sm",variant:"outline",onClick:()=>h(i),children:s.jsx(De,{className:"h-4 w-4"})}),s.jsx(k,{size:"sm",variant:"outline",onClick:()=>a(i),children:s.jsx(Pe,{className:"h-4 w-4"})})]})})]},i.id))})]})}),s.jsx("div",{className:"mt-4",children:s.jsx(we,{currentPage:o,totalPages:j,onPageChange:w,showingFrom:p,showingTo:g,total:C,perPage:m,onPerPageChange:O})})]}),n&&s.jsx($e,{customer:n,open:!!n,onClose:()=>h(null),onSuccess:()=>{h(null),x(o)}}),l&&s.jsx(Be,{customer:l,open:!!l,onClose:()=>f(null)}),s.jsx(He,{customer:D,open:!!D,onClose:()=>a(null),onSuccess:()=>{a(null),x(o)}})]})}function ze({open:t,onClose:e}){const[u,r]=c.useState(!1),d=async n=>{try{r(!0),await Ee(n),X.success("Customer created successfully"),e(),window.location.reload()}catch(h){console.error("Failed to create customer:",h),X.error("Failed to create customer. Please try again.")}finally{r(!1)}};return s.jsx(Y,{open:t,onOpenChange:e,children:s.jsxs(Z,{className:"max-w-md","aria-describedby":"customer-create-description",children:[s.jsx(ce,{children:s.jsx(ee,{children:"Add New Customer"})}),s.jsx("div",{id:"customer-create-description",className:"sr-only",children:"Form to create a new customer"}),s.jsx(me,{onSubmit:d,loading:u})]})})}const Ie=[{title:"Dashboard",href:Fe()},{title:"Customers",href:"/customers"}];function xs(){const t=de.c(29),{url:e}=xe(),u=new URLSearchParams(window.location.search),[r,d]=c.useState(!1),[n,h]=c.useState(u.get("search")||"");let l;t[0]===Symbol.for("react.memo_cache_sentinel")?(l=()=>{const w=new URLSearchParams(window.location.search).get("search");w&&h(w)},t[0]=l):l=t[0];let f;t[1]!==e?(f=[e],t[1]=e,t[2]=f):f=t[2],c.useEffect(l,f);let D;t[3]===Symbol.for("react.memo_cache_sentinel")?(D=s.jsx(ue,{title:"Customers"}),t[3]=D):D=t[3];let a;t[4]===Symbol.for("react.memo_cache_sentinel")?(a=s.jsx("h1",{className:"text-3xl font-bold",children:"Customers"}),t[4]=a):a=t[4];let o;t[5]!==d?(o=()=>d(!0),t[5]=d,t[6]=o):o=t[6];let N;t[7]===Symbol.for("react.memo_cache_sentinel")?(N=s.jsx(Le,{className:"h-4 w-4 mr-2"}),t[7]=N):N=t[7];let j;t[8]!==o?(j=s.jsxs("div",{className:"flex items-center justify-between",children:[a,s.jsxs(k,{onClick:o,children:[N,"Add Customer"]})]}),t[8]=o,t[9]=j):j=t[9];let P;t[10]===Symbol.for("react.memo_cache_sentinel")?(P=s.jsx(ne,{children:"Customer List"}),t[10]=P):P=t[10];let C;t[11]===Symbol.for("react.memo_cache_sentinel")?(C=s.jsx(je,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),t[11]=C):C=t[11];let b;t[12]===Symbol.for("react.memo_cache_sentinel")?(b=x=>{h(x.target.value);const w=new URLSearchParams(window.location.search);x.target.value?w.set("search",x.target.value):w.delete("search"),fe.get("/customers",Object.fromEntries(w),{preserveState:!0,replace:!0})},t[12]=b):b=t[12];let p;t[13]!==n?(p=s.jsx(oe,{children:s.jsxs("div",{className:"flex items-center justify-between",children:[P,s.jsxs("div",{className:"relative max-w-sm",children:[C,s.jsx(K,{placeholder:"Search customers...",value:n,onChange:b,className:"pl-10"})]})]})}),t[13]=n,t[14]=p):p=t[14];let y;t[15]!==n?(y=s.jsx(ie,{children:s.jsx(qe,{search:n})}),t[15]=n,t[16]=y):y=t[16];let g;t[17]!==p||t[18]!==y?(g=s.jsxs(le,{children:[p,y]}),t[17]=p,t[18]=y,t[19]=g):g=t[19];let v;t[20]!==d?(v=()=>d(!1),t[20]=d,t[21]=v):v=t[21];let m;t[22]!==r||t[23]!==v?(m=s.jsx(ze,{open:r,onClose:v}),t[22]=r,t[23]=v,t[24]=m):m=t[24];let S;return t[25]!==g||t[26]!==m||t[27]!==j?(S=s.jsxs(pe,{breadcrumbs:Ie,children:[D,s.jsxs("div",{className:"space-y-6 p-4",children:[j,g,m]})]}),t[25]=g,t[26]=m,t[27]=j,t[28]=S):S=t[28],S}export{xs as default};
