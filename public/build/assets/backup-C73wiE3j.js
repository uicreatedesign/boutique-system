import{b as k,r as a,j as e,H as D,T as _,a as j,d as R}from"./app-pwOgIdW3.js";import{A as U,y as H,w as M,B as g}from"./app-layout-Bg3L5Oye.js";import{S as T}from"./layout--5AydPCU.js";import{c as t,a as r,C as i,b as c}from"./card-DXsoVNLq.js";import{B as l}from"./app-logo-icon-Dxs_odns.js";import{A as b,a as y}from"./alert-DMycydmr.js";import{D as o}from"./download-BnJyoVv9.js";import{C as q}from"./calendar-IrcOle3S.js";import{C as z}from"./circle-check-big-CzOziM3T.js";/* empty css            */import"./index-C7iv0R3u.js";import"./index-Zg_VQMPS.js";import"./index-C4J_hXM0.js";import"./input-BM91w7k_.js";import"./index-DZZlyDoJ.js";const E=[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]],F=k("Database",E);const I=[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]],N=k("Upload",I),L=[{title:"Backup Settings",href:"/settings/backup"}];function te({backups:n=[],settings:d}){const[m,u]=a.useState(!1),[x,w]=a.useState(d?.auto_backup_enabled||!1),[p,v]=a.useState(d?.retention_days||30),[h,f]=a.useState(!1);console.log("Backups received:",n),console.log("Settings received:",d);const B=()=>{u(!0),window.location.href="/api/settings/backup/create",setTimeout(()=>{u(!1),j.reload()},2e3)},C=s=>{window.location.href=`/api/settings/backup/download/${s}`},S=async s=>{s.preventDefault(),f(!0);try{await R.put("/api/settings/backup/settings",{auto_backup_enabled:x,retention_days:p}),j.reload()}catch(A){console.error("Failed to update settings:",A)}finally{f(!1)}};return e.jsxs(U,{breadcrumbs:L,children:[e.jsx(D,{title:"Database Backup - Settings"}),e.jsx(T,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold",children:"Database Backup"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Manage your boutique data backups and restore points"})]}),e.jsxs(b,{children:[e.jsx(H,{className:"h-4 w-4"}),e.jsx(y,{children:"Regular backups help protect your boutique data. We recommend creating backups before major updates or changes."})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs(t,{children:[e.jsx(r,{children:e.jsxs(i,{className:"flex items-center gap-2",children:[e.jsx(o,{className:"h-5 w-5"}),"Create Backup"]})}),e.jsxs(c,{className:"space-y-4",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Create a complete backup of your boutique database including customers, orders, and settings."}),e.jsx(l,{onClick:B,disabled:m,className:"w-full",children:m?e.jsxs(e.Fragment,{children:[e.jsx(M,{className:"h-4 w-4 mr-2 animate-spin"}),"Creating Backup..."]}):e.jsxs(e.Fragment,{children:[e.jsx(o,{className:"h-4 w-4 mr-2"}),"Create Backup Now"]})})]})]}),e.jsxs(t,{children:[e.jsx(r,{children:e.jsxs(i,{className:"flex items-center gap-2",children:[e.jsx(N,{className:"h-5 w-5"}),"Restore Backup"]})}),e.jsxs(c,{className:"space-y-4",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Restore your boutique data from a previous backup file."}),e.jsxs(b,{children:[e.jsx(_,{className:"h-4 w-4"}),e.jsx(y,{className:"text-xs",children:"This will overwrite current data. Use with caution."})]}),e.jsxs(l,{variant:"outline",className:"w-full",children:[e.jsx(N,{className:"h-4 w-4 mr-2"}),"Choose Backup File"]})]})]})]}),e.jsxs(t,{children:[e.jsx(r,{children:e.jsxs(i,{className:"flex items-center gap-2",children:[e.jsx(q,{className:"h-5 w-5"}),"Backup History"]})}),e.jsx(c,{children:e.jsx("div",{className:"space-y-3",children:n.length===0?e.jsx("p",{className:"text-sm text-muted-foreground text-center py-4",children:"No backup history available"}):n.map(s=>e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-muted rounded",children:e.jsx(F,{className:"h-4 w-4"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-sm",children:s.date}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["Size: ",s.size]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(g,{variant:s.type==="automatic"?"secondary":"default",children:s.type}),e.jsxs(g,{className:"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200",children:[e.jsx(z,{className:"h-3 w-3 mr-1"}),s.status]}),e.jsx(l,{variant:"ghost",size:"sm",onClick:()=>C(s.id),children:e.jsx(o,{className:"h-4 w-4"})})]})]},s.id))})})]}),e.jsxs(t,{children:[e.jsx(r,{children:e.jsx(i,{children:"Automatic Backups"})}),e.jsx(c,{children:e.jsxs("form",{onSubmit:S,className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"Daily Automatic Backups"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Automatically create backups every day at 2:00 AM"})]}),e.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:x,onChange:s=>w(s.target.checked),className:"sr-only peer"}),e.jsx("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full rtl:peer-checked:after:-translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:start-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-blue-600"})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-medium",children:"Retention Period"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Keep backups for specified days"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"number",min:"1",max:"365",value:p,onChange:s=>v(Number(s.target.value)),className:"w-20 px-3 py-2 border rounded-md"}),e.jsx("span",{className:"text-sm text-muted-foreground",children:"days"})]})]}),e.jsx(l,{type:"submit",disabled:h,className:"sm:w-auto",children:h?"Saving...":"Save Settings"})]})})]})]})})]})}export{te as default};
