import{r as d,u as me,d as ue,j as e,H as he,t as W}from"./app-SG5kOH_X.js";import{A as xe,C as je,b as M,c as P,d as R}from"./app-layout-Bcr1Tlge.js";import{B as o}from"./app-logo-icon-Dz-0iVEl.js";import{I as j}from"./input-rkZVFfFn.js";import{L as a}from"./label-Dr95cb8O.js";import{T as U}from"./textarea-DC1xlfFZ.js";import{S as m,a as u,b as h,c as x,d as l,C as pe}from"./select-jIWFUsPL.js";import{c as p,a as g,C as v,b as _}from"./card-CK13e0SI.js";import{C as X}from"./checkbox-CuMRTmCQ.js";import{R as ge,a as D,I}from"./radio-group-D67n25xF.js";import{C as O}from"./camera-CGI1KH6Z.js";import{T}from"./trash-2-C8sdlo-D.js";/* empty css            */import"./index-CUgtGy35.js";import"./index-DJFLLwEA.js";import"./index-C4J_hXM0.js";import"./index-pmHSJmjl.js";import"./check-D0w8CGYY.js";function Oe({order:i,customers:Y,garmentTypes:Z,tailors:ee,fabrics:se,statuses:te,categories:G=[]}){const[b,L]=d.useState([]),[f,ae]=d.useState("skip"),[N,y]=d.useState(!1),[C,ie]=d.useState({}),[A,re]=d.useState(""),[w,V]=d.useState(i.design_image||null),[S,B]=d.useState(i.customer_fabric_photo||null),[k,E]=d.useState(i.boutique_fabric_photo||null),z=d.useRef(null),$=d.useRef(null),H=d.useRef(null),{data:r,setData:t,put:ne,processing:J,errors:c}=me({customer_id:i.customer_id.toString(),garment_type_id:i.garment_type_id.toString(),tailor_id:i.tailor_id.toString(),measurement_id:i.measurement_id?.toString()||"",measurement_option:"skip",new_measurement_type:"",new_measurements:{},measurement_notes:"",fabric_id:i.fabric_id?.toString()||"",customer_fabric:i.customer_fabric||!1,boutique_fabric:i.boutique_fabric||!1,customer_fabric_photo:null,boutique_fabric_photo:null,design_image:null,payment_method:"cash",stitching_status_id:i.stitching_status_id.toString(),order_date:i.order_date,delivery_date:i.delivery_date,priority:i.priority,total_amount:i.total_amount.toString(),advance_paid:i.advance_paid?.toString()||"",discount:i.discount.toString(),special_instructions:i.special_instructions||"",notes:i.notes||""});d.useEffect(()=>{i.customer_id&&K(i.customer_id.toString())},[]);const K=async s=>{if(s)try{const n=await ue.get(`/api/measurements?customer_id=${s}`);L(n.data)}catch(n){console.error("Failed to fetch measurements:",n)}else L([])},le=async s=>{t("customer_id",s),K(s)},ce=s=>{ae(s),t("measurement_option",s),y(s==="new")},q=G?.find(s=>s.slug===A),de=s=>{s.preventDefault();const n={...r,new_measurements:f==="new"?C:{}};ne(`/orders/${i.id}`,{data:n,onSuccess:()=>{W.success("Order updated successfully")},onError:()=>{W.error("Failed to update order")}})};return e.jsxs(xe,{children:[e.jsx(he,{title:`Edit Order ${i.order_number}`}),e.jsxs("div",{className:"space-y-6 p-4 max-w-6xl mx-auto",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("h1",{className:"text-3xl font-bold",children:["Edit Order ",i.order_number]})}),e.jsxs("form",{onSubmit:de,className:"space-y-6",children:[e.jsxs(p,{children:[e.jsx(g,{children:e.jsx(v,{children:"Order Details"})}),e.jsx(_,{className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(a,{children:"Customer *"}),e.jsxs(m,{value:r.customer_id,onValueChange:le,children:[e.jsx(u,{children:e.jsx(h,{placeholder:"Select customer"})}),e.jsxs(x,{children:[e.jsx("div",{className:"px-2 pb-2 sticky top-0 bg-popover z-10",children:e.jsx(j,{placeholder:"Search customer...",className:"h-8",onChange:s=>{const n=s.target.value.toLowerCase();document.querySelectorAll("[data-customer-item]").forEach(Q=>{const oe=Q.textContent?.toLowerCase()||"";Q.style.display=oe.includes(n)?"":"none"})},onKeyDown:s=>s.stopPropagation()})}),Y.map(s=>e.jsx(l,{value:s.id.toString(),"data-customer-item":!0,children:s.name},s.id))]})]}),c.customer_id&&e.jsx("p",{className:"text-sm text-red-500 mt-1",children:c.customer_id})]}),e.jsxs("div",{children:[e.jsx(a,{children:"Garment Type *"}),e.jsxs(m,{value:r.garment_type_id,onValueChange:s=>t("garment_type_id",s),children:[e.jsx(u,{children:e.jsx(h,{placeholder:"Select garment type"})}),e.jsx(x,{children:Z.map(s=>e.jsx(l,{value:s.id.toString(),children:s.name},s.id))})]}),c.garment_type_id&&e.jsx("p",{className:"text-sm text-red-500 mt-1",children:c.garment_type_id})]}),e.jsxs("div",{children:[e.jsx(a,{children:"Tailor *"}),e.jsxs(m,{value:r.tailor_id,onValueChange:s=>t("tailor_id",s),children:[e.jsx(u,{children:e.jsx(h,{placeholder:"Select tailor"})}),e.jsx(x,{children:ee.map(s=>e.jsx(l,{value:s.id.toString(),children:s.name},s.id))})]}),c.tailor_id&&e.jsx("p",{className:"text-sm text-red-500 mt-1",children:c.tailor_id})]}),e.jsxs("div",{children:[e.jsx(a,{children:"Status *"}),e.jsxs(m,{value:r.stitching_status_id,onValueChange:s=>t("stitching_status_id",s),children:[e.jsx(u,{children:e.jsx(h,{})}),e.jsx(x,{children:te.map(s=>e.jsx(l,{value:s.id.toString(),children:s.name},s.id))})]})]})]})})]}),r.customer_id&&e.jsxs(p,{children:[e.jsx(g,{children:e.jsx(v,{children:"Measurements"})}),e.jsxs(_,{className:"space-y-4",children:[e.jsxs(ge,{value:f,onValueChange:ce,children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(D,{value:"skip",id:"skip"}),e.jsx(a,{htmlFor:"skip",className:"cursor-pointer",children:"Skip measurements"})]}),b.length>0&&e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(D,{value:"existing",id:"existing"}),e.jsx(a,{htmlFor:"existing",className:"cursor-pointer",children:"Use existing measurement"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(D,{value:"new",id:"new"}),e.jsx(a,{htmlFor:"new",className:"cursor-pointer",children:"Create new measurement"})]})]}),f==="existing"&&b.length>0&&e.jsxs("div",{children:[e.jsx(a,{children:"Select Measurement"}),e.jsxs(m,{value:r.measurement_id,onValueChange:s=>t("measurement_id",s),children:[e.jsx(u,{children:e.jsx(h,{placeholder:"Select measurement"})}),e.jsx(x,{children:b.map(s=>e.jsxs(l,{value:s.id.toString(),children:[s.measurement_type," - ",new Date(s.created_at).toLocaleDateString()]},s.id))})]})]}),f==="new"&&e.jsxs("div",{className:"space-y-4 border-t pt-4",children:[e.jsxs("div",{children:[e.jsx(a,{children:"Measurement Type *"}),e.jsxs(m,{value:A,onValueChange:s=>{re(s),t("new_measurement_type",s)},children:[e.jsx(u,{children:e.jsx(h,{placeholder:"Select measurement type"})}),e.jsx(x,{children:G?.map(s=>e.jsx(l,{value:s.slug,children:s.name},s.id))||[]})]})]}),q&&e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(a,{className:"text-base font-semibold",children:[q.name," Measurements"]}),e.jsx(o,{type:"button",variant:"ghost",size:"sm",onClick:()=>y(!N),children:N?e.jsx(pe,{className:"h-4 w-4"}):e.jsx(je,{className:"h-4 w-4"})})]}),N&&e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4 p-4 bg-gray-50 rounded-lg",children:q.fields.map(s=>e.jsxs("div",{children:[e.jsxs(a,{htmlFor:s.slug,className:"text-sm",children:[s.name," (",s.unit,")",s.is_required&&e.jsx("span",{className:"text-red-500 ml-1",children:"*"})]}),e.jsx(j,{id:s.slug,type:"number",step:"0.1",placeholder:"0.0",value:C[s.slug]||"",onChange:n=>{const F={...C,[s.slug]:n.target.value};ie(F),t("new_measurements",F)},required:s.is_required})]},s.id))}),e.jsxs("div",{children:[e.jsx(a,{children:"Measurement Notes"}),e.jsx(U,{value:r.measurement_notes,onChange:s=>t("measurement_notes",s.target.value),rows:2,placeholder:"Any special notes about measurements..."})]})]})]})]})]}),e.jsxs(p,{children:[e.jsx(g,{children:e.jsx(v,{children:"Fabric & Design"})}),e.jsxs(_,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(X,{id:"customer_fabric",checked:r.customer_fabric,onCheckedChange:s=>t("customer_fabric",s)}),e.jsx("label",{htmlFor:"customer_fabric",className:"text-sm cursor-pointer",children:"Customer provided fabric"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(X,{id:"boutique_fabric",checked:r.boutique_fabric,onCheckedChange:s=>t("boutique_fabric",s)}),e.jsx("label",{htmlFor:"boutique_fabric",className:"text-sm cursor-pointer",children:"Boutique provided fabric"})]})]}),r.boutique_fabric&&e.jsxs("div",{children:[e.jsx(a,{children:"Fabric"}),e.jsxs(m,{value:r.fabric_id,onValueChange:s=>t("fabric_id",s),children:[e.jsx(u,{children:e.jsx(h,{placeholder:"Select fabric"})}),e.jsx(x,{children:se.map(s=>e.jsxs(l,{value:s.id.toString(),children:[s.name," - $",s.price_per_meter,"/meter"]},s.id))})]})]}),r.boutique_fabric&&e.jsxs("div",{children:[e.jsx(a,{children:"Boutique Fabric Photo"}),e.jsxs("div",{className:"flex items-center gap-4 mt-2",children:[e.jsxs(M,{className:"h-24 w-24 rounded-md",children:[e.jsx(P,{src:k||void 0,alt:"Boutique Fabric",className:"object-cover"}),e.jsx(R,{className:"rounded-md bg-muted",children:e.jsx(I,{className:"h-8 w-8 text-muted-foreground"})})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(o,{type:"button",variant:"outline",size:"sm",onClick:()=>H.current?.click(),children:[e.jsx(O,{className:"h-4 w-4 mr-2"}),k?"Change":"Upload"]}),k&&e.jsxs(o,{type:"button",variant:"outline",size:"sm",onClick:()=>{E(null),t("boutique_fabric_photo",null)},children:[e.jsx(T,{className:"h-4 w-4 mr-2"}),"Remove"]})]})]}),e.jsx("input",{ref:H,type:"file",accept:"image/*",onChange:s=>{const n=s.target.files?.[0];n&&(t("boutique_fabric_photo",n),E(URL.createObjectURL(n)))},className:"hidden"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-2",children:"Upload boutique fabric photo (JPG, PNG or GIF. Max 2MB)"})]}),r.customer_fabric&&e.jsxs("div",{children:[e.jsx(a,{children:"Customer Fabric Photo"}),e.jsxs("div",{className:"flex items-center gap-4 mt-2",children:[e.jsxs(M,{className:"h-24 w-24 rounded-md",children:[e.jsx(P,{src:S||void 0,alt:"Fabric",className:"object-cover"}),e.jsx(R,{className:"rounded-md bg-muted",children:e.jsx(I,{className:"h-8 w-8 text-muted-foreground"})})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(o,{type:"button",variant:"outline",size:"sm",onClick:()=>$.current?.click(),children:[e.jsx(O,{className:"h-4 w-4 mr-2"}),S?"Change":"Upload"]}),S&&e.jsxs(o,{type:"button",variant:"outline",size:"sm",onClick:()=>{B(null),t("customer_fabric_photo",null)},children:[e.jsx(T,{className:"h-4 w-4 mr-2"}),"Remove"]})]})]}),e.jsx("input",{ref:$,type:"file",accept:"image/*",onChange:s=>{const n=s.target.files?.[0];n&&(t("customer_fabric_photo",n),B(URL.createObjectURL(n)))},className:"hidden"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-2",children:"Upload customer fabric photo (JPG, PNG or GIF. Max 2MB)"})]}),e.jsxs("div",{children:[e.jsx(a,{children:"Design Image"}),e.jsxs("div",{className:"flex items-center gap-4 mt-2",children:[e.jsxs(M,{className:"h-24 w-24 rounded-md",children:[e.jsx(P,{src:w||void 0,alt:"Design",className:"object-cover"}),e.jsx(R,{className:"rounded-md bg-muted",children:e.jsx(I,{className:"h-8 w-8 text-muted-foreground"})})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(o,{type:"button",variant:"outline",size:"sm",onClick:()=>z.current?.click(),children:[e.jsx(O,{className:"h-4 w-4 mr-2"}),w?"Change":"Upload"]}),w&&e.jsxs(o,{type:"button",variant:"outline",size:"sm",onClick:()=>{V(null),t("design_image",null)},children:[e.jsx(T,{className:"h-4 w-4 mr-2"}),"Remove"]})]})]}),e.jsx("input",{ref:z,type:"file",accept:"image/*",onChange:s=>{const n=s.target.files?.[0];n&&(t("design_image",n),V(URL.createObjectURL(n)))},className:"hidden"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-2",children:"Upload design reference image (JPG, PNG or GIF. Max 2MB)"})]})]})]}),e.jsxs(p,{children:[e.jsx(g,{children:e.jsx(v,{children:"Pricing & Payment"})}),e.jsxs(_,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx(a,{children:"Total Amount *"}),e.jsx(j,{type:"number",step:"0.01",value:r.total_amount,onChange:s=>t("total_amount",s.target.value),placeholder:"0.00"}),c.total_amount&&e.jsx("p",{className:"text-sm text-red-500 mt-1",children:c.total_amount})]}),e.jsxs("div",{children:[e.jsx(a,{children:"Discount"}),e.jsx(j,{type:"number",step:"0.01",value:r.discount,onChange:s=>t("discount",s.target.value),placeholder:"0.00"})]}),e.jsxs("div",{children:[e.jsx(a,{children:"Advance Paid"}),e.jsx(j,{type:"number",step:"0.01",value:r.advance_paid,onChange:s=>t("advance_paid",s.target.value),placeholder:"0.00"})]})]}),e.jsxs("div",{children:[e.jsx(a,{children:"Payment Method"}),e.jsxs(m,{value:r.payment_method,onValueChange:s=>t("payment_method",s),children:[e.jsx(u,{children:e.jsx(h,{})}),e.jsxs(x,{children:[e.jsx(l,{value:"cash",children:"Cash"}),e.jsx(l,{value:"card",children:"Card"}),e.jsx(l,{value:"upi",children:"UPI"}),e.jsx(l,{value:"bank_transfer",children:"Bank Transfer"}),e.jsx(l,{value:"other",children:"Other"})]})]})]})]})]}),e.jsxs(p,{children:[e.jsx(g,{children:e.jsx(v,{children:"Dates & Additional Information"})}),e.jsxs(_,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx(a,{children:"Order Date *"}),e.jsx(j,{type:"date",value:r.order_date,onChange:s=>t("order_date",s.target.value)}),c.order_date&&e.jsx("p",{className:"text-sm text-red-500 mt-1",children:c.order_date})]}),e.jsxs("div",{children:[e.jsx(a,{children:"Delivery Date *"}),e.jsx(j,{type:"date",value:r.delivery_date,onChange:s=>t("delivery_date",s.target.value)}),c.delivery_date&&e.jsx("p",{className:"text-sm text-red-500 mt-1",children:c.delivery_date})]}),e.jsxs("div",{children:[e.jsx(a,{children:"Priority *"}),e.jsxs(m,{value:r.priority,onValueChange:s=>t("priority",s),children:[e.jsx(u,{children:e.jsx(h,{})}),e.jsxs(x,{children:[e.jsx(l,{value:"normal",children:"Normal"}),e.jsx(l,{value:"urgent",children:"Urgent"})]})]})]})]}),e.jsxs("div",{children:[e.jsx(a,{children:"Special Instructions"}),e.jsx(U,{value:r.special_instructions,onChange:s=>t("special_instructions",s.target.value),rows:3,placeholder:"Any special instructions for this order..."})]}),e.jsxs("div",{children:[e.jsx(a,{children:"Notes"}),e.jsx(U,{value:r.notes,onChange:s=>t("notes",s.target.value),rows:2,placeholder:"Internal notes..."})]})]})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(o,{type:"button",variant:"outline",onClick:()=>window.history.back(),children:"Cancel"}),e.jsx(o,{type:"submit",disabled:J,children:J?"Updating...":"Update Order"})]})]})]})]})}export{Oe as default};
